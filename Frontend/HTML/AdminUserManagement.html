<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="/css/styles.css">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Management</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f4f4f4; }
    .container { margin: 20px; }
    .search-container { margin-bottom: 20px; }
    .search-container input { padding: 8px; width: 300px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
    th { background: #ecf0f1; }
    button { padding: 5px 10px; margin-right: 5px; }
    .actions { display: flex; }
    .modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
    .modal-content { background: #fff; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 50%; border-radius: 8px; }
    .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; }
    .close:hover, .close:focus { color: black; text-decoration: none; cursor: pointer; }
  </style>
</head>
<body>
  <div class="container">
    <h1>User Management</h1>
    <div class="search-container">
      <input type="text" placeholder="Search users..." id="userSearch" onkeyup="searchUsers()">
      <select id="roleFilter">
        <option value="">All Roles</option>
        <option value="User">User</option>
        <option value="Moderator">Moderator</option>
        <option value="Admin">Admin</option>
      </select>
      <select id="statusFilter">
        <option value="">All Statuses</option>
        <option value="Active">Active</option>
        <option value="Suspended">Suspended</option>
      </select>
    </div>
    <table id="usersTable">
      <thead>
        <tr>
          <th>Username</th>
          <th>Email</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>john_doe</td>
          <td>john@example.com</td>
          <td>User</td>
          <td>Active</td>
          <td class="actions">
            <button onclick="openEditModal('john_doe')">Edit</button>
            <button onclick="toggleUserStatus('john_doe', 'Active')">Suspend</button>
            <button onclick="deleteUser('john_doe')">Delete</button>
          </td>
        </tr>
        <tr>
          <td>jane_smith</td>
          <td>jane@example.com</td>
          <td>Moderator</td>
          <td>Active</td>
          <td class="actions">
            <button onclick="openEditModal('jane_smith')">Edit</button>
            <button onclick="toggleUserStatus('jane_smith', 'Active')">Suspend</button>
            <button onclick="deleteUser('jane_smith')">Delete</button>
          </td>
        </tr>
        <tr>
          <td>mark_lee</td>
          <td>mark@example.com</td>
          <td>Admin</td>
          <td>Suspended</td>
          <td class="actions">
            <button onclick="openEditModal('mark_lee')">Edit</button>
            <button onclick="toggleUserStatus('mark_lee', 'Suspended')">Unsuspend</button>
            <button onclick="deleteUser('mark_lee')">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Edit User Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeEditModal()">&times;</span>
      <h2>Edit User</h2>
      <form id="editUserForm">
        <label for="editUsername">Username</label>
        <input type="text" id="editUsername" name="editUsername" required>
        <label for="editEmail">Email</label>
        <input type="email" id="editEmail" name="editEmail" required>
        <label for="editRole">Role</label>
        <select id="editRole" name="editRole">
          <option value="User">User</option>
          <option value="Moderator">Moderator</option>
          <option value="Admin">Admin</option>
        </select>
        <label for="editStatus">Status</label>
        <select id="editStatus" name="editStatus">
          <option value="Active">Active</option>
          <option value="Suspended">Suspended</option>
        </select>
        <button type="submit">Save Changes</button>
      </form>
    </div>
  </div>

  <script>
    function searchUsers() {
      const input = document.getElementById("userSearch");
      const roleFilter = document.getElementById("roleFilter").value;
      const statusFilter = document.getElementById("statusFilter").value;
      const filter = input.value.toLowerCase();
      const table = document.getElementById("usersTable");
      const trs = table.getElementsByTagName("tr");
      for (let i = 1; i < trs.length; i++) { // Skip header row
        let visible = false;
        const tds = trs[i].getElementsByTagName("td");
        const role = tds[2].textContent;
        const status = tds[3].textContent;
        if ((roleFilter === "" || role === roleFilter) && (statusFilter === "" || status === statusFilter)) {
          for (let j = 0; j < tds.length; j++) {
            if (tds[j].textContent.toLowerCase().includes(filter)) {
              visible = true;
              break;
            }
          }
        }
        trs[i].style.display = visible ? "" : "none";
      }
    }

    function openEditModal(username) {
      const modal = document.getElementById("editModal");
      modal.style.display = "block";
      // Populate form with user data (mock data for now)
      document.getElementById("editUsername").value = username;
      document.getElementById("editEmail").value = username + "@example.com";
      document.getElementById("editRole").value = "User";
      document.getElementById("editStatus").value = "Active";
    }

    function closeEditModal() {
      const modal = document.getElementById("editModal");
      modal.style.display = "none";
    }

    function toggleUserStatus(username, currentStatus) {
      const newStatus = currentStatus === "Active" ? "Suspended" : "Active";
      alert(`User ${username} status changed to ${newStatus}`);
      // Implement status change logic here
    }

    function deleteUser(username) {
      if (confirm(`Are you sure you want to delete ${username}?`)) {
        alert(`User ${username} deleted`);
        // Implement delete logic here
      }
    }

    document.getElementById("editUserForm").addEventListener("submit", function(e) {
      e.preventDefault();
      alert("User details updated");
      closeEditModal();
    });
  </script>
</body>
</html>
